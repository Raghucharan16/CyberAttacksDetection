<!DOCTYPE html>
<html>
<head>
    <title>Threat Detection Dashboard</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .input-group { margin: 15px 0; }
        input { width: 200px; padding: 5px; }
        #result { padding: 20px; margin: 20px 0; border-radius: 5px; }
        .threat { background: #ffebee; border: 2px solid #ff1744; }
        .safe { background: #e8f5e9; border: 2px solid #00e676; }
    </style>
</head>
<body>
    <h1>Network Threat Detection</h1>
    
    <div class="input-group">
        <label>Flow Duration (ms):</label>
        <input type="number" id="flow_duration" value="0">
    </div>
    
    <div class="input-group">
        <label>Destination Port:</label>
        <input type="number" id="dest_port" value="80">
    </div>
    
    <div class="input-group">
        <label>Total Fwd Packets:</label>
        <input type="number" id="fwd_packets" value="10">
    </div>

    <button onclick="analyze()">Check Traffic</button>
    <div id="result"></div>

    <h2>Recent Threats</h2>
    <div id="threat-list"></div>

    <script>
        function analyze() {
            const inputs = {
                'Flow Duration': $('#flow_duration').val(),
                'Destination Port': $('#dest_port').val(),
                'Total Fwd Packets': $('#fwd_packets').val(),
                'Total Length of Fwd Packets': 1500,  // Default value
                'Flow Bytes/s': 100000                // Default value
            };

            $.ajax({
                url: '/detect',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(inputs),
                success: function(response) {
                    const result = $('#result');
                    result.removeClass('threat safe');
                    
                    if(response.threat) {
                        result.html(`
                            <h3>‚ö†Ô∏è Threat Detected!</h3>
                            <p>Confidence: ${(response.confidence * 100).toFixed(1)}%</p>
                        `).addClass('threat');
                    } else {
                        result.html(`
                            <h3>‚úÖ Traffic Normal</h3>
                            <p>Risk Level: ${(response.confidence * 100).toFixed(1)}%</p>
                        `).addClass('safe');
                    }
                    updateThreatList();
                }
            });
        }

        function updateThreatList() {
            $.get('/threats', function(logs) {
                let html = '';
                logs.slice(-5).reverse().forEach(log => {
                    html += `
                        <div class="threat-entry">
                            <p>‚è∞ ${new Date(log.timestamp * 1000).toLocaleString()}</p>
                            <p>üö© ${log.data.DestinationPort} : ${log.data.FlowBytes}</p>
                            <p>üîí Confidence: ${(log.confidence * 100).toFixed(1)}%</p>
                        </div>
                    `;
                });
                $('#threat-list').html(html);
            });
        }

        // Initial load
        updateThreatList();
        setInterval(updateThreatList, 5000);
    </script>
</body>
</html>